"use strict";(self.webpackChunkHRMS_Admin_Panel=self.webpackChunkHRMS_Admin_Panel||[]).push([[7239],{67239:(e,l,s)=>{s.r(l),s.d(l,{default:()=>f});var a=s(89379),n=s(9950),t=(s(4695),s(28429)),c=s(9449),d=(s(20404),s(12815),s(97514),s(82391)),r=s(52610),o=s(79739),i=(s(40078),s(34263),s(32003)),m=(s(25825),s(70591)),u=s(82543),v=s(82569),h=s(59091),x=(s(77923),s(98631),s(61977)),g=s(60984),b=s(4159),j=s.n(b),N=s(90607),H=s(44414);function f(){var e;const l=(0,t.Zp)(),s=(0,v.wA)(),b=(0,t.zy)(),{customerList:{data:f}}=(0,v.d4)(e=>e.masterslice),[k,_]=(0,n.useState)(null),[p,O]=(0,n.useState)(""),[S,T]=(0,n.useState)(null),[E,I]=(0,n.useState)(""),[C,w]=(0,n.useState)(!1),[A,M]=(0,n.useState)(null),[y,R]=(0,n.useState)({checkIn:null,checkOut:null}),[D,Y]=(0,n.useState)([{start:null,end:null}]),{register:F,handleSubmit:W,setValue:U,clearErrors:P,reset:L,watch:V,control:q,trigger:z,formState:{errors:B}}=(0,c.mN)({defaultValues:{breaks:[{start:null,end:null}]}}),{fields:Z,append:G,remove:J}=(0,c.jz)({control:q,name:"breaks"});var K=null===b||void 0===b?void 0:b.state;(0,n.useEffect)(()=>{var e;const l={emp_leave_company:null===(e=u.wz[0])||void 0===e?void 0:e.key};0===(null===f||void 0===f?void 0:f.length)&&s((0,h.hI)(l))},[]),(0,n.useEffect)(()=>{if(K&&(null===f||void 0===f?void 0:f.length)>0){var e,l,a;s((0,h.iC)(!0));const n=null===K||void 0===K||null===(e=K.breaks)||void 0===e?void 0:e.map(e=>({start:e.start?j()("".concat(e.start),"HH:mm:ss"):null,end:e.end?j()("".concat(e.end),"HH:mm:ss"):null}));U("breaks",n);const t=(null===f||void 0===f?void 0:f.find(e=>e.id==(null===K||void 0===K?void 0:K.emp_id)))||null;M(t||null),U(null===u.ic||void 0===u.ic?void 0:u.ic.EMPLOYEE_ID,null===K||void 0===K?void 0:K.emp_id),U("dob1",null!==K&&void 0!==K&&K.date?j()(null===K||void 0===K?void 0:K.date).format("DD-MM-YYYY"):null),U("checkIn",null!==K&&void 0!==K&&null!==(l=K.checkInTimes)&&void 0!==l&&l[0]?j()("".concat(K.date," ").concat(K.checkInTimes[0]),"YYYY-MM-DD HH:mm:ss"):null),U("checkOut",null!==K&&void 0!==K&&null!==(a=K.checkOutTimes)&&void 0!==a&&a[0]?j()("".concat(K.date," ").concat(K.checkOutTimes[0]),"YYYY-MM-DD HH:mm:ss"):null),s((0,h.iC)(!1))}console.log("userData?.departmentuserData?.department",null===K||void 0===K?void 0:K.department)},[K,f]);return console.log("watch()",V("breaks")),(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(x.default,{isActive:C,message:"Please Wait"}),(0,H.jsxs)("div",{className:"container-fluid mw-100",children:[(0,H.jsx)(o.A,{title:K?"Edit Attendance":"Add Attendance",header:"Attendance List",subHeaderOnlyView:K?"Edit Attendance":"Add Attendance"}),(0,H.jsxs)("div",{className:"row",children:[A&&(0,H.jsx)("div",{className:"col-12 justify-content-center",children:(0,H.jsx)("div",{className:"card  ",children:(0,H.jsxs)("div",{className:"p-md-4 p-4 row_2",children:[(0,H.jsx)("div",{className:"p-8 py-3 border-bottom chat-meta-user d-flex align-items-center justify-content-between mb-4",children:(0,H.jsx)("h5",{className:"text-secondary mb-0 fw-semibold fs-5",children:"Employee Attendance Details"})}),console.log("getWorkingHours",(0,m.VP)(V("breaks"))),(0,H.jsx)("div",{className:"row",children:[{label:"Work Hours",value:(0,m.fR)(j()(V("checkIn")).format("HH:mm:ss"),j()(V("checkOut")).format("HH:mm:ss"),(0,m.VP)(V("breaks")))||0},{label:"Total Break",value:(0,m.VP)(V("breaks"))+"m"}].map((e,l)=>(0,H.jsx)("div",{className:"col-12 col-sm-6 col-md-2 col-lg-4 ",children:(0,H.jsx)("div",{className:"card border-1 zoom-in them-light shadow-sm",children:(0,H.jsxs)("div",{className:"card-body text-center",children:[(0,H.jsx)("p",{className:"fw-semibold fs-4 text-custom-theam ",children:e.label}),(0,H.jsx)("h5",{className:"fw-semibold text-dark mb-0 fs-5",children:e.value||"-"})]})},l)}))})]})})}),(0,H.jsx)("div",{className:"col-12 justify-content-center",children:(0,H.jsx)("div",{className:"row justify-content-center ",children:(0,H.jsx)("form",{onSubmit:W(async e=>{try{var a;s((0,h.iC)(!0));let n={employee_id:null===A||void 0===A?void 0:A.id,date:(0,m.qr)(null===e||void 0===e?void 0:e.dob1,null===u.ow||void 0===u.ow?void 0:u.ow.DATE_DASH_TIME_FORMAT),check_in_time:null!==e&&void 0!==e&&e.checkIn?j()(e.checkIn).format("HH:mm"):null,check_out_time:null!==e&&void 0!==e&&e.checkOut?j()(e.checkOut).format("HH:mm"):null,breaks:Array.isArray(null===e||void 0===e?void 0:e.breaks)&&(null===e||void 0===e||null===(a=e.breaks)||void 0===a?void 0:a.length)>0?e.breaks.map(e=>({start:null!==e&&void 0!==e&&e.start?j()(e.start,null===u.Hg||void 0===u.Hg?void 0:u.Hg.TIME_WITH_SECONDS_12_HOUR_FORMAT).format("HH:mm"):null,end:null!==e&&void 0!==e&&e.end?j()(e.end,null===u.Hg||void 0===u.Hg?void 0:u.Hg.TIME_WITH_SECONDS_12_HOUR_FORMAT).format("HH:mm"):null})):[],lat:"0.000",log:"0.000",location_id:"TRACEWAVE"};K||(0,r.jY)(n).then(e=>{(null===e||void 0===e?void 0:e.code)==i.NC.SUCCESS?((0,d.k1)(null===e||void 0===e?void 0:e.message),l(null===N.R||void 0===N.R?void 0:N.R.ATTENDANCE_LIST),s((0,h.iC)(!1))):((0,d.uU)(e.message),s((0,h.iC)(!1)))})}catch(n){(0,d.uU)("Somthing went wrong"),s((0,h.iC)(!1))}}),children:(0,H.jsx)("div",{className:"card",children:(0,H.jsxs)("div",{className:"card-body",children:[(0,H.jsx)("div",{className:"row justify-content-center",children:(0,H.jsx)("div",{className:"col-auto",children:(0,H.jsx)("div",{className:"card shadow-sm custom-card"})})}),(0,H.jsxs)("div",{className:"row col-12 col-md-12 ",children:[(0,H.jsxs)("div",{className:"col-md-6 ",children:[(0,H.jsxs)("div",{className:"mb-4",children:[(0,H.jsxs)("label",{htmlFor:"gender1",className:"form-label fw-semibold",children:["Select Employee",(0,H.jsx)("span",{className:"text-danger ms-1",children:"*"})]}),(0,H.jsx)("div",{className:"input-group border rounded-1",children:(0,H.jsxs)("select",(0,a.A)((0,a.A)({id:"gender1",className:"form-control ps-2 p-2",autoComplete:"nope"},F(u.ic.EMPLOYEE,{required:"Select employee"})),{},{onChange:e=>{const l=e.target.value,s=f.find(e=>String(e.id)===String(l));M(s||null),U(null===u.ic||void 0===u.ic?void 0:u.ic.EMPLOYEE_ID,s.employee_id)},children:[(0,H.jsx)("option",{value:"",children:"Select employee"}),(0,m.st)(f)]}))}),(0,H.jsx)("label",{className:"errorc ps-1 pt-1",children:null===(e=B[u.ic.EMPLOYEE])||void 0===e?void 0:e.message})]}),(0,H.jsxs)("div",{className:"mb-4",children:[Z.map((e,l)=>(0,H.jsxs)("div",{className:"row g-3 mb-3",children:[(0,H.jsxs)("div",{className:"col-12 col-md-5",children:[(0,H.jsxs)("label",{htmlFor:"breaks[".concat(l,"].start"),className:"form-label fw-semibold",children:["Break In Time ",(0,H.jsx)("span",{className:"text-danger",children:"*"})]}),(0,H.jsx)(c.xI,{name:"breaks.".concat(l,".start"),control:q,render:e=>{let{field:s,fieldState:{error:a}}=e;return(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(g.A,{id:"breakIn-".concat(l),className:"form-control custom-datepicker w-100",picker:"time",format:null===u.Hg||void 0===u.Hg?void 0:u.Hg.TIME_WITH_SECONDS_12_HOUR_FORMAT,z:!0,value:s.value?j()(s.value,null===u.Hg||void 0===u.Hg?void 0:u.Hg.TIME_WITH_SECONDS_12_HOUR_FORMAT):null,onChange:e=>s.onChange(e?j()(e).format(null===u.Hg||void 0===u.Hg?void 0:u.Hg.TIME_WITH_SECONDS_12_HOUR_FORMAT):null),allowClear:!1}),a&&(0,H.jsx)("small",{className:"text-danger",children:a.message})]})}})]}),(0,H.jsxs)("div",{className:"col-12 col-md-5",children:[(0,H.jsxs)("label",{htmlFor:"breaks[".concat(l,"].end"),className:"form-label fw-semibold",children:["Break Out Time ",(0,H.jsx)("span",{className:"text-danger",children:"*"})]}),(0,H.jsx)(c.xI,{name:"breaks.".concat(l,".end"),control:q,render:e=>{let{field:s,fieldState:{error:a}}=e;return(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(g.A,{id:"breakOut-".concat(l),className:"form-control custom-datepicker w-100",picker:"time",format:null===u.Hg||void 0===u.Hg?void 0:u.Hg.TIME_WITH_SECONDS_12_HOUR_FORMAT,value:s.value?j()(s.value,null===u.Hg||void 0===u.Hg?void 0:u.Hg.TIME_WITH_SECONDS_12_HOUR_FORMAT):null,onChange:e=>s.onChange(e?j()(e).format(null===u.Hg||void 0===u.Hg?void 0:u.Hg.TIME_WITH_SECONDS_12_HOUR_FORMAT):null),allowClear:!1}),a&&(0,H.jsx)("small",{className:"text-danger",children:null===a||void 0===a?void 0:a.message})]})}})]}),(0,H.jsx)("div",{className:"col-12 col-md-2 d-flex align-items-end",children:Z.length>1&&(0,H.jsx)("button",{type:"button",className:"btn text-white bg-danger btn-sm",style:{border:"1px solid transparent"},onMouseEnter:e=>e.currentTarget.style.border="1px solid #fa896b",onMouseLeave:e=>e.currentTarget.style.border="1px solid transparent",onClick:()=>J(l),children:"Remove"})})]},e.id)),(0,H.jsx)("button",{type:"button",className:"btn btn-primary",onClick:()=>G({start:null,end:null}),children:"+ Add Break"})]})]}),(0,H.jsxs)("div",{className:"col-md-6",children:[(0,H.jsx)("div",{className:"mb-4",children:(0,H.jsxs)("div",{className:"col-12 col-md-10",children:[(0,H.jsxs)("label",{htmlFor:"dob1",className:"form-label fw-semibold",children:["Date ",(0,H.jsx)("span",{className:"text-danger ms-1",children:"*"})]}),(0,H.jsx)(c.xI,{name:"dob1",control:q,rules:{required:"Date is required"},render:e=>{let{field:l}=e;return(0,H.jsx)(g.A,{id:"dob1",className:"form-control custom-datepicker w-100",format:"DD-MM-YYYY",value:l.value?j()(l.value):null,onChange:e=>l.onChange(e?e.toISOString():null),allowClear:!1,picker:"date"})}}),B.dob1&&(0,H.jsx)("small",{className:"text-danger",children:B.dob1.message})]})}),(0,H.jsxs)("div",{className:"row mb-4 g-3",children:[(0,H.jsxs)("div",{className:"col-12 col-md-5",children:[(0,H.jsxs)("label",{htmlFor:"checkIn",className:"form-label fw-semibold",children:["Check In Time ",(0,H.jsx)("span",{className:"text-danger ms-1",children:"*"})]}),(0,H.jsx)(c.xI,{name:"checkIn",control:q,rules:{required:"Check In time is required"},render:e=>{let{field:l}=e;return(0,H.jsx)(g.A,(0,a.A)((0,a.A)({},l),{},{id:"checkIn",className:"form-control custom-datepicker w-100",picker:"time",format:null===u.Hg||void 0===u.Hg?void 0:u.Hg.TIME_WITH_SECONDS_12_HOUR_FORMAT,value:l.value,onChange:e=>l.onChange(e),allowClear:!1}))}}),B.checkIn&&(0,H.jsx)("span",{className:"text-danger small",children:B.checkIn.message})]}),(0,H.jsxs)("div",{className:"col-12 col-md-5",children:[(0,H.jsxs)("label",{htmlFor:"checkOut",className:"form-label fw-semibold",children:["Check Out Time ",(0,H.jsx)("span",{className:"text-danger ms-1",children:"*"})]}),(0,H.jsx)(c.xI,{name:"checkOut",control:q,render:e=>{let{field:l}=e;return(0,H.jsx)(g.A,(0,a.A)((0,a.A)({},l),{},{id:"checkOut",className:"form-control custom-datepicker w-100",picker:"time",format:null===u.Hg||void 0===u.Hg?void 0:u.Hg.TIME_WITH_SECONDS_12_HOUR_FORMAT,value:l.value,onChange:e=>l.onChange(e),allowClear:!1}))}}),B.checkOut&&(0,H.jsx)("span",{className:"text-danger small",children:B.checkOut.message})]})]})]}),(0,H.jsx)("div",{className:"modal-footer justify-content-center mb-3",children:(0,H.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Submit"})})]})]})})})})})]})]})]})}}}]);